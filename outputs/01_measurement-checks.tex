% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  10pt,
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[landscape,margin=0.7in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\setlength{\LTcapwidth}{\textwidth}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Measurement checks --- HPT (Czech data)},
  pdfauthor={HPT and Extremism project},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Measurement checks --- HPT (Czech data)}
\usepackage{etoolbox}
\makeatletter
\providecommand{\subtitle}[1]{% add subtitle to \maketitle
  \apptocmd{\@title}{\par {\large #1 \par}}{}{}
}
\makeatother
\subtitle{Reliability, dimensionality, presentism-contextualization
contrast, and ICCs}
\author{HPT and Extremism project}
\date{2025-12-12}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{3}
\tableofcontents
}
\hypertarget{what-this-document-does}{%
\section{What this document does}\label{what-this-document-does}}

This report checks whether our \textbf{Historical Perspective-Taking
(HPT)} instrument behaves well \textbf{before} we run any hypothesis
tests.

We do four things:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Reliability:} Are the HPT subscales internally consistent? We
  report \textbf{Cronbach's alpha (\(\alpha\))} and \textbf{McDonald's
  omega (\(\omega\))} for \textbf{POP}, \textbf{ROA}, \textbf{CONT}
  (three items each; 1--4).
\item
  \textbf{Dimensionality (CFA/EFA):} Does the \textbf{factor structure}
  match prior research (e.g., \textbf{POP+CONT} vs \textbf{ROA}, or
  three correlated factors)?
\item
  \textbf{Presentism--contextualization contrast:} Do \textbf{POP}
  (presentist) and \textbf{CONT} (contextualization) show the expected
  contrast?
\item
  \textbf{Clustering (ICCs):} Are scores clustered by \textbf{school}
  and \textbf{class-within-school}?
\end{enumerate}

\begin{quote}
\textbf{Composite scores used} (for descriptives/ICCs and later files):
- \textbf{POP\_rev = 5 − POP\_raw} (so higher = more contextualized). -
\textbf{HPT\_CTX6 = mean(POP\_rev, CONT)} (default composite). -
\textbf{HPT\_TOT9 = mean(POP\_rev, CONT, ROA)} (includes ROA;
robustness).
\end{quote}

\hypertarget{setup-and-data-loading}{%
\section{Setup and data loading}\label{setup-and-data-loading}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{options}\NormalTok{(}\AttributeTok{width =} \DecValTok{120}\NormalTok{)}

\CommentTok{\# Data handling \& plots}
\FunctionTok{library}\NormalTok{(tidyverse)}

\CommentTok{\# Psychometrics}
\FunctionTok{library}\NormalTok{(psych)        }\CommentTok{\# alpha, omega, polychoric, EFA helpers}
\FunctionTok{library}\NormalTok{(lavaan)       }\CommentTok{\# CFA}
\FunctionTok{library}\NormalTok{(semTools)     }\CommentTok{\# model comparisons \& extras}

\CommentTok{\# Multilevel ICCs}
\FunctionTok{library}\NormalTok{(lme4)}
\FunctionTok{library}\NormalTok{(performance)}

\CommentTok{\# Tables}
\FunctionTok{library}\NormalTok{(knitr)}

\CommentTok{\# Make kableExtra use longtable/booktabs and avoid loading tabu}
\FunctionTok{options}\NormalTok{(}\AttributeTok{kableExtra.latex.load\_packages =} \ConstantTok{FALSE}\NormalTok{)}
\FunctionTok{library}\NormalTok{(kableExtra)}

\CommentTok{\# Load the dataset created in 00\_data{-}preparation}
\FunctionTok{load}\NormalTok{(}\StringTok{"normalised\_responses.RData"}\NormalTok{)}
\FunctionTok{stopifnot}\NormalTok{(}\FunctionTok{exists}\NormalTok{(}\StringTok{"normalised\_responses"}\NormalTok{))}
\NormalTok{dat }\OtherTok{\textless{}{-}}\NormalTok{ normalised\_responses}

\CommentTok{\# Ensure clustering identifiers and unique class id}
\FunctionTok{stopifnot}\NormalTok{(}\FunctionTok{all}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"school\_id"}\NormalTok{,}\StringTok{"class\_label"}\NormalTok{) }\SpecialCharTok{\%in\%} \FunctionTok{names}\NormalTok{(dat)))}
\NormalTok{dat }\OtherTok{\textless{}{-}}\NormalTok{ dat }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{school\_id   =} \FunctionTok{as.factor}\NormalTok{(school\_id),}
    \AttributeTok{class\_label =} \FunctionTok{as.factor}\NormalTok{(class\_label),}
    \AttributeTok{class\_id    =} \FunctionTok{interaction}\NormalTok{(school\_id, class\_label, }\AttributeTok{drop =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}

\CommentTok{\# POP reversed item{-}wise and subscale helper}
\NormalTok{POP\_rev\_items }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"POP"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)}

\CommentTok{\# Reverse POP items (1–4)}
\NormalTok{dat }\OtherTok{\textless{}{-}}\NormalTok{ dat }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \FunctionTok{across}\NormalTok{(}
      \FunctionTok{all\_of}\NormalTok{(POP\_rev\_items),}
      \SpecialCharTok{\textasciitilde{}} \DecValTok{5} \SpecialCharTok{{-}} \FunctionTok{suppressWarnings}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(.)),}
      \AttributeTok{.names =} \StringTok{"\{.col\}\_rev"}     \CommentTok{\# \textless{}\textless{}\textless{} THIS was the culprit}
\NormalTok{    )}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{HPT\_POP\_raw =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{all\_of}\NormalTok{(POP\_rev\_items)), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{HPT\_POP\_rev =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{all\_of}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(POP\_rev\_items, }\StringTok{"\_rev"}\NormalTok{))), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{HPT\_CONT    =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{across}\NormalTok{(CONT1}\SpecialCharTok{:}\NormalTok{CONT3), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{HPT\_ROA     =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{across}\NormalTok{(ROA1}\SpecialCharTok{:}\NormalTok{ROA3),   }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{HPT\_CTX6    =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(HPT\_POP\_rev, HPT\_CONT), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{HPT\_TOT9    =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(HPT\_POP\_rev, HPT\_CONT, HPT\_ROA), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}

\NormalTok{print\_tbl }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, caption, }\AttributeTok{digits =} \DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{TRUE}\NormalTok{) \{}
  \FunctionTok{kbl}\NormalTok{(df, }\AttributeTok{booktabs =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{longtable =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{caption =}\NormalTok{ caption, }\AttributeTok{digits =}\NormalTok{ digits, }\AttributeTok{escape =}\NormalTok{ escape) }\SpecialCharTok{|\textgreater{}}
    \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{full\_width =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{latex\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"hold\_position"}\NormalTok{))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

We verify that \textbf{HPT items} and \textbf{class labels} exist. If
something is missing, we stop with a clear message.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# {-}{-} check{-}columns {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{hpt\_cols }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"POP"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{), }\FunctionTok{paste0}\NormalTok{(}\StringTok{"ROA"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{), }\FunctionTok{paste0}\NormalTok{(}\StringTok{"CONT"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{))}
\NormalTok{need   }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(hpt\_cols, }\StringTok{"class\_label"}\NormalTok{, }\StringTok{"school\_id"}\NormalTok{)}
\NormalTok{miss   }\OtherTok{\textless{}{-}} \FunctionTok{setdiff}\NormalTok{(need, }\FunctionTok{names}\NormalTok{(dat))}
\ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(miss)) }\FunctionTok{stop}\NormalTok{(}\StringTok{"Missing variables: "}\NormalTok{, }\FunctionTok{paste}\NormalTok{(miss, }\AttributeTok{collapse =} \StringTok{", "}\NormalTok{))}

\CommentTok{\# Keep only rows that are COMPLETE on all HPT items AND have class\_label and school\_id}
\NormalTok{keep }\OtherTok{\textless{}{-}} \FunctionTok{complete.cases}\NormalTok{(dat[, hpt\_cols]) }\SpecialCharTok{\&} \SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(dat}\SpecialCharTok{$}\NormalTok{class\_label) }\SpecialCharTok{\&} \SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(dat}\SpecialCharTok{$}\NormalTok{school\_id)}

\NormalTok{analysis\_df }\OtherTok{\textless{}{-}}\NormalTok{ dat[keep, }\FunctionTok{c}\NormalTok{(hpt\_cols, }\StringTok{"class\_label"}\NormalTok{, }\StringTok{"school\_id"}\NormalTok{, }\StringTok{"class\_id"}\NormalTok{)] }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{as\_tibble}\NormalTok{()}

\NormalTok{nrow\_all   }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(dat)}
\NormalTok{nrow\_keep  }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(analysis\_df)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Rows in full data: "}\NormalTok{, nrow\_all,  }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{,}
    \StringTok{"Rows kept (complete HPT + class\_label + school\_id): "}\NormalTok{, nrow\_keep, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\AttributeTok{sep =} \StringTok{""}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows in full data: 234
## Rows kept (complete HPT + class_label + school_id): 221
\end{verbatim}

\hypertarget{step-1-descriptives-and-scale-construction}{%
\section{Step 1 --- Descriptives and scale
construction}\label{step-1-descriptives-and-scale-construction}}

\textbf{Why:} Simple summaries catch obvious data problems and help
readers develop intuition.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hpt\_items }\OtherTok{\textless{}{-}}\NormalTok{ analysis\_df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\FunctionTok{all\_of}\NormalTok{(hpt\_cols))  }\CommentTok{\# 9 HPT items}

\CommentTok{\# Subscales and composites with POP reversed for composites}
\NormalTok{hpt\_scores }\OtherTok{\textless{}{-}}\NormalTok{ hpt\_items }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{POP\_raw =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{select}\NormalTok{(., }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"POP"}\NormalTok{)),  }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{ROA     =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{select}\NormalTok{(., }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"ROA"}\NormalTok{)),  }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{CONT    =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{select}\NormalTok{(., }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"CONT"}\NormalTok{)), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{POP\_rev   =} \DecValTok{5} \SpecialCharTok{{-}}\NormalTok{ POP\_raw,}
    \AttributeTok{HPT\_CTX6  =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(POP\_rev, CONT), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{HPT\_TOT9  =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(POP\_rev, CONT, ROA), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}

\FunctionTok{summary}\NormalTok{(}\FunctionTok{select}\NormalTok{(hpt\_scores, POP\_raw, POP\_rev, ROA, CONT, HPT\_CTX6, HPT\_TOT9))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     POP_raw         POP_rev           ROA             CONT          HPT_CTX6        HPT_TOT9    
##  Min.   :1.000   Min.   :1.333   Min.   :1.000   Min.   :1.000   Min.   :1.333   Min.   :1.667  
##  1st Qu.:1.333   1st Qu.:2.333   1st Qu.:2.333   1st Qu.:2.333   1st Qu.:2.500   1st Qu.:2.444  
##  Median :2.000   Median :3.000   Median :3.000   Median :2.667   Median :2.833   Median :2.889  
##  Mean   :2.017   Mean   :2.983   Mean   :2.804   Mean   :2.735   Mean   :2.859   Mean   :2.841  
##  3rd Qu.:2.667   3rd Qu.:3.667   3rd Qu.:3.333   3rd Qu.:3.333   3rd Qu.:3.333   3rd Qu.:3.222  
##  Max.   :3.667   Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :3.889
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor}\NormalTok{(}\FunctionTok{select}\NormalTok{(hpt\_scores, POP\_raw, ROA, CONT, HPT\_CTX6, HPT\_TOT9), }\AttributeTok{use =} \StringTok{"pairwise.complete.obs"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             POP_raw        ROA       CONT   HPT_CTX6   HPT_TOT9
## POP_raw   1.0000000 -0.1515670 -0.3568641 -0.8024568 -0.6851161
## ROA      -0.1515670  1.0000000  0.3678874  0.3220708  0.6827642
## CONT     -0.3568641  0.3678874  1.0000000  0.8437887  0.8109413
## HPT_CTX6 -0.8024568  0.3220708  0.8437887  1.0000000  0.9116056
## HPT_TOT9 -0.6851161  0.6827642  0.8109413  0.9116056  1.0000000
\end{verbatim}

\hypertarget{step-2-reliability-alpha-and-omega-for-poproacont}{%
\section{\texorpdfstring{Step 2 --- Reliability: \(\alpha\) and
\(\omega\) for
POP--ROA--CONT}{Step 2 --- Reliability: \textbackslash alpha and \textbackslash omega for POP--ROA--CONT}}\label{step-2-reliability-alpha-and-omega-for-poproacont}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alpha\_poly }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  pc }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{polychoric}\NormalTok{(x)}\SpecialCharTok{$}\NormalTok{rho}
\NormalTok{  psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(pc, }\AttributeTok{n.obs =} \FunctionTok{nrow}\NormalTok{(x))}
\NormalTok{\}}
\NormalTok{omega\_poly }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  pc }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{polychoric}\NormalTok{(x)}\SpecialCharTok{$}\NormalTok{rho}
\NormalTok{  psych}\SpecialCharTok{::}\FunctionTok{omega}\NormalTok{(pc, }\AttributeTok{n.obs =} \FunctionTok{nrow}\NormalTok{(x), }\AttributeTok{nfactors =} \DecValTok{1}\NormalTok{, }\AttributeTok{plot =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{\}}

\NormalTok{subsets }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{POP  =}\NormalTok{ hpt\_items }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"POP"}\NormalTok{)),}
  \AttributeTok{ROA  =}\NormalTok{ hpt\_items }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"ROA"}\NormalTok{)),}
  \AttributeTok{CONT =}\NormalTok{ hpt\_items }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"CONT"}\NormalTok{))}
\NormalTok{)}

\NormalTok{rel\_table }\OtherTok{\textless{}{-}}\NormalTok{ purrr}\SpecialCharTok{::}\FunctionTok{imap\_dfr}\NormalTok{(subsets, }\ControlFlowTok{function}\NormalTok{(df, nm)\{}
\NormalTok{  a\_raw  }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(df)}
\NormalTok{  a\_poly }\OtherTok{\textless{}{-}} \FunctionTok{alpha\_poly}\NormalTok{(df)}
\NormalTok{  om     }\OtherTok{\textless{}{-}} \FunctionTok{omega\_poly}\NormalTok{(df)}
  \FunctionTok{tibble}\NormalTok{(}
    \AttributeTok{scale =}\NormalTok{ nm,}
    \AttributeTok{k\_items =} \FunctionTok{ncol}\NormalTok{(df),}
    \AttributeTok{alpha\_raw  =} \FunctionTok{unname}\NormalTok{(a\_raw}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha),}
    \AttributeTok{alpha\_poly =} \FunctionTok{unname}\NormalTok{(a\_poly}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha),}
    \AttributeTok{omega\_total =} \FunctionTok{unname}\NormalTok{(om}\SpecialCharTok{$}\NormalTok{omega.tot),}
    \AttributeTok{omega\_hier  =} \FunctionTok{unname}\NormalTok{(om}\SpecialCharTok{$}\NormalTok{omega.h)}
\NormalTok{  )}
\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required namespace: GPArotation
\end{verbatim}

\begin{verbatim}
## Omega_h for 1 factor is not meaningful, just omega_t
## Omega_h for 1 factor is not meaningful, just omega_t
## Omega_h for 1 factor is not meaningful, just omega_t
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print\_tbl}\NormalTok{(rel\_table, }\AttributeTok{digits =} \DecValTok{3}\NormalTok{, }\AttributeTok{caption =} \StringTok{"Reliability of HPT subscales (alpha and omega)."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[t]{lrrrr}
\caption{\label{tab:reliability}Reliability of HPT subscales (alpha and omega).}\\
\toprule
scale & k\_items & alpha\_raw & alpha\_poly & omega\_total\\
\midrule
POP & 3 & 0.479 & 0.535 & 0.560\\
ROA & 3 & 0.432 & 0.453 & 0.538\\
CONT & 3 & 0.635 & 0.690 & 0.691\\
\bottomrule
\end{longtable}

\hypertarget{step-3-dimensionality-cfaefa}{%
\section{Step 3 --- Dimensionality
(CFA/EFA)}\label{step-3-dimensionality-cfaefa}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hpt\_ord }\OtherTok{\textless{}{-}}\NormalTok{ hpt\_items  }\CommentTok{\# treat items as ordered}

\NormalTok{m1\_2factor }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}}
\StringTok{F1 =\textasciitilde{} POP1 + POP2 + POP3 + CONT1 + CONT2 + CONT3}
\StringTok{F2 =\textasciitilde{} ROA1 + ROA2 + ROA3}
\StringTok{F1 \textasciitilde{}\textasciitilde{} F2}
\StringTok{\textquotesingle{}}
\NormalTok{m2\_3factor }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}}
\StringTok{POP  =\textasciitilde{} POP1 + POP2 + POP3}
\StringTok{CONT =\textasciitilde{} CONT1 + CONT2 + CONT3}
\StringTok{ROA  =\textasciitilde{} ROA1 + ROA2 + ROA3}
\StringTok{POP \textasciitilde{}\textasciitilde{} CONT + ROA}
\StringTok{CONT \textasciitilde{}\textasciitilde{} ROA}
\StringTok{\textquotesingle{}}
\NormalTok{m3\_1factor }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}}
\StringTok{G =\textasciitilde{} POP1 + POP2 + POP3 + ROA1 + ROA2 + ROA3 + CONT1 + CONT2 + CONT3}
\StringTok{\textquotesingle{}}

\NormalTok{fit\_2 }\OtherTok{\textless{}{-}} \FunctionTok{cfa}\NormalTok{(m1\_2factor, }\AttributeTok{data =}\NormalTok{ hpt\_ord, }\AttributeTok{ordered =}\NormalTok{ hpt\_cols, }\AttributeTok{estimator =} \StringTok{"WLSMV"}\NormalTok{)}
\NormalTok{fit\_3 }\OtherTok{\textless{}{-}} \FunctionTok{cfa}\NormalTok{(m2\_3factor, }\AttributeTok{data =}\NormalTok{ hpt\_ord, }\AttributeTok{ordered =}\NormalTok{ hpt\_cols, }\AttributeTok{estimator =} \StringTok{"WLSMV"}\NormalTok{)}
\NormalTok{fit\_1 }\OtherTok{\textless{}{-}} \FunctionTok{cfa}\NormalTok{(m3\_1factor, }\AttributeTok{data =}\NormalTok{ hpt\_ord, }\AttributeTok{ordered =}\NormalTok{ hpt\_cols, }\AttributeTok{estimator =} \StringTok{"WLSMV"}\NormalTok{)}

\CommentTok{\# Compare fits}
\NormalTok{semTools}\SpecialCharTok{::}\FunctionTok{compareFit}\NormalTok{(fit\_2, fit\_3, fit\_1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## The following lavaan models were compared:
##     fit_3
##     fit_2
##     fit_1
## To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{report\_fit }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(fit) \{}
  \FunctionTok{list}\NormalTok{(}
    \AttributeTok{indices =} \FunctionTok{fitMeasures}\NormalTok{(fit, }\FunctionTok{c}\NormalTok{(}\StringTok{"cfi"}\NormalTok{,}\StringTok{"tli"}\NormalTok{,}\StringTok{"rmsea"}\NormalTok{,}\StringTok{"rmsea.ci.lower"}\NormalTok{,}\StringTok{"rmsea.ci.upper"}\NormalTok{,}\StringTok{"srmr"}\NormalTok{)),}
    \AttributeTok{loadings =} \FunctionTok{standardizedSolution}\NormalTok{(fit) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{as\_tibble}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(op }\SpecialCharTok{==} \StringTok{"=\textasciitilde{}"}\NormalTok{)}
\NormalTok{  )}
\NormalTok{\}}

\NormalTok{cfa\_summary }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \StringTok{\textasciigrave{}}\AttributeTok{2{-}factor (POP+CONT vs ROA)}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{report\_fit}\NormalTok{(fit\_2),}
  \StringTok{\textasciigrave{}}\AttributeTok{3{-}factor (POP/CONT/ROA)}\StringTok{\textasciigrave{}}    \OtherTok{=} \FunctionTok{report\_fit}\NormalTok{(fit\_3),}
  \StringTok{\textasciigrave{}}\AttributeTok{1{-}factor (general)}\StringTok{\textasciigrave{}}         \OtherTok{=} \FunctionTok{report\_fit}\NormalTok{(fit\_1)}
\NormalTok{)}

\NormalTok{purrr}\SpecialCharTok{::}\FunctionTok{iwalk}\NormalTok{(cfa\_summary, }\ControlFlowTok{function}\NormalTok{(x, nm)\{}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{\#\#\#"}\NormalTok{, nm, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{print}\NormalTok{(x}\SpecialCharTok{$}\NormalTok{indices)}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{kable}\NormalTok{(x}\SpecialCharTok{$}\NormalTok{loadings, }\AttributeTok{digits =} \DecValTok{3}\NormalTok{))}
\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## ### 2-factor (POP+CONT vs ROA) 
##            cfi            tli          rmsea rmsea.ci.lower rmsea.ci.upper           srmr 
##          0.971          0.960          0.048          0.004          0.077          0.066 
## 
## 
## |lhs |op |rhs   | est.std|    se|       z| pvalue| ci.lower| ci.upper|
## |:---|:--|:-----|-------:|-----:|-------:|------:|--------:|--------:|
## |F1  |=~ |POP1  |   0.571| 0.069|   8.264|  0.000|    0.435|    0.706|
## |F1  |=~ |POP2  |   0.230| 0.072|   3.186|  0.001|    0.089|    0.372|
## |F1  |=~ |POP3  |   0.413| 0.062|   6.662|  0.000|    0.291|    0.534|
## |F1  |=~ |CONT1 |  -0.687| 0.061| -11.290|  0.000|   -0.806|   -0.567|
## |F1  |=~ |CONT2 |  -0.592| 0.064|  -9.218|  0.000|   -0.718|   -0.466|
## |F1  |=~ |CONT3 |  -0.620| 0.060| -10.290|  0.000|   -0.738|   -0.502|
## |F2  |=~ |ROA1  |   0.611| 0.088|   6.955|  0.000|    0.439|    0.783|
## |F2  |=~ |ROA2  |   0.187| 0.089|   2.099|  0.036|    0.012|    0.361|
## |F2  |=~ |ROA3  |   0.615| 0.084|   7.341|  0.000|    0.451|    0.780|
## 
## ### 3-factor (POP/CONT/ROA) 
##            cfi            tli          rmsea rmsea.ci.lower rmsea.ci.upper           srmr 
##          0.997          0.995          0.016          0.000          0.058          0.054 
## 
## 
## |lhs  |op |rhs   | est.std|    se|      z| pvalue| ci.lower| ci.upper|
## |:----|:--|:-----|-------:|-----:|------:|------:|--------:|--------:|
## |POP  |=~ |POP1  |   0.759| 0.094|  8.061|   0.00|    0.574|    0.943|
## |POP  |=~ |POP2  |   0.297| 0.080|  3.711|   0.00|    0.140|    0.453|
## |POP  |=~ |POP3  |   0.510| 0.066|  7.689|   0.00|    0.380|    0.640|
## |CONT |=~ |CONT1 |   0.709| 0.062| 11.487|   0.00|    0.588|    0.830|
## |CONT |=~ |CONT2 |   0.607| 0.065|  9.328|   0.00|    0.479|    0.734|
## |CONT |=~ |CONT3 |   0.641| 0.061| 10.486|   0.00|    0.521|    0.761|
## |ROA  |=~ |ROA1  |   0.613| 0.087|  7.072|   0.00|    0.443|    0.782|
## |ROA  |=~ |ROA2  |   0.192| 0.089|  2.169|   0.03|    0.018|    0.366|
## |ROA  |=~ |ROA3  |   0.612| 0.083|  7.399|   0.00|    0.450|    0.774|
## 
## ### 1-factor (general) 
##            cfi            tli          rmsea rmsea.ci.lower rmsea.ci.upper           srmr 
##          0.952          0.935          0.061          0.032          0.088          0.073 
## 
## 
## |lhs |op |rhs   | est.std|    se|       z| pvalue| ci.lower| ci.upper|
## |:---|:--|:-----|-------:|-----:|-------:|------:|--------:|--------:|
## |G   |=~ |POP1  |   0.563| 0.069|   8.143|  0.000|    0.427|    0.698|
## |G   |=~ |POP2  |   0.219| 0.072|   3.048|  0.002|    0.078|    0.360|
## |G   |=~ |POP3  |   0.403| 0.062|   6.501|  0.000|    0.282|    0.525|
## |G   |=~ |ROA1  |  -0.458| 0.070|  -6.511|  0.000|   -0.596|   -0.320|
## |G   |=~ |ROA2  |  -0.135| 0.076|  -1.784|  0.074|   -0.284|    0.013|
## |G   |=~ |ROA3  |  -0.465| 0.066|  -7.021|  0.000|   -0.594|   -0.335|
## |G   |=~ |CONT1 |  -0.676| 0.059| -11.393|  0.000|   -0.792|   -0.560|
## |G   |=~ |CONT2 |  -0.585| 0.063|  -9.233|  0.000|   -0.709|   -0.461|
## |G   |=~ |CONT3 |  -0.608| 0.058| -10.400|  0.000|   -0.723|   -0.494|
\end{verbatim}

\hypertarget{optional-efa-polychoric}{%
\subsubsection{Optional: EFA
(polychoric)}\label{optional-efa-polychoric}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pc }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{polychoric}\NormalTok{(hpt\_ord)}\SpecialCharTok{$}\NormalTok{rho}
\NormalTok{efa2 }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{fa}\NormalTok{(pc, }\AttributeTok{nfactors =} \DecValTok{2}\NormalTok{, }\AttributeTok{fm =} \StringTok{"pa"}\NormalTok{, }\AttributeTok{rotate =} \StringTok{"oblimin"}\NormalTok{)}
\NormalTok{efa3 }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{fa}\NormalTok{(pc, }\AttributeTok{nfactors =} \DecValTok{3}\NormalTok{, }\AttributeTok{fm =} \StringTok{"pa"}\NormalTok{, }\AttributeTok{rotate =} \StringTok{"oblimin"}\NormalTok{)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{EFA (2 factors):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## EFA (2 factors):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(efa2}\SpecialCharTok{$}\NormalTok{loadings, }\AttributeTok{cutoff =} \FloatTok{0.25}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Loadings:
##       PA1    PA2   
## POP1  -0.442  0.266
## POP2          0.534
## POP3          0.472
## ROA1   0.569       
## ROA2   0.292  0.301
## ROA3   0.554       
## CONT1  0.655       
## CONT2  0.524       
## CONT3  0.532       
## 
##                  PA1   PA2
## SS loadings    1.934 0.763
## Proportion Var 0.215 0.085
## Cumulative Var 0.215 0.300
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{EFA (3 factors):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## EFA (3 factors):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(efa3}\SpecialCharTok{$}\NormalTok{loadings, }\AttributeTok{cutoff =} \FloatTok{0.25}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Loadings:
##       PA1    PA2    PA3   
## POP1          0.400       
## POP2          0.362  0.284
## POP3          0.744       
## ROA1                 0.479
## ROA2                 0.348
## ROA3                 0.556
## CONT1  0.479              
## CONT2  0.521              
## CONT3  0.765              
## 
##                  PA1   PA2   PA3
## SS loadings    1.189 0.888 0.861
## Proportion Var 0.132 0.099 0.096
## Cumulative Var 0.132 0.231 0.326
\end{verbatim}

\hypertarget{step-4-presentismcontextualization-contrast-pop-vs-cont}{%
\section{Step 4 --- Presentism--contextualization contrast (POP vs
CONT)}\label{step-4-presentismcontextualization-contrast-pop-vs-cont}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{contrast\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ hpt\_scores }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{mean\_POP   =} \FunctionTok{mean}\NormalTok{(POP\_raw,  }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),  }\AttributeTok{sd\_POP   =} \FunctionTok{sd}\NormalTok{(POP\_raw,  }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{mean\_CONT  =} \FunctionTok{mean}\NormalTok{(CONT,     }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),  }\AttributeTok{sd\_CONT  =} \FunctionTok{sd}\NormalTok{(CONT,     }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{r\_POP\_CONT =} \FunctionTok{cor}\NormalTok{(POP\_raw, CONT, }\AttributeTok{use =} \StringTok{"pairwise.complete.obs"}\NormalTok{)}
\NormalTok{  )}

\FunctionTok{print\_tbl}\NormalTok{(contrast\_tbl, }\AttributeTok{digits =} \DecValTok{3}\NormalTok{, }\AttributeTok{caption =} \StringTok{"POP (raw) vs CONT: means, SDs, and correlation."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[t]{rrrrr}
\caption{\label{tab:pop-cont-contrast}POP (raw) vs CONT: means, SDs, and correlation.}\\
\toprule
mean\_POP & sd\_POP & mean\_CONT & sd\_CONT & r\_POP\_CONT\\
\midrule
2.017 & 0.656 & 2.735 & 0.73 & -0.357\\
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t\_test }\OtherTok{\textless{}{-}} \FunctionTok{t.test}\NormalTok{(hpt\_scores}\SpecialCharTok{$}\NormalTok{POP\_raw, hpt\_scores}\SpecialCharTok{$}\NormalTok{CONT, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{t\_test}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Paired t-test
## 
## data:  hpt_scores$POP_raw and hpt_scores$CONT
## t = -9.345, df = 220, p-value < 2.2e-16
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  -0.8693599 -0.5665376
## sample estimates:
## mean difference 
##      -0.7179487
\end{verbatim}

\hypertarget{step-5-distribution-checks}{%
\section{Step 5 --- Distribution
checks}\label{step-5-distribution-checks}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Item distributions}
\NormalTok{long\_items }\OtherTok{\textless{}{-}}\NormalTok{ hpt\_items }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{everything}\NormalTok{(), }\AttributeTok{names\_to =} \StringTok{"item"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"score"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(long\_items, }\FunctionTok{aes}\NormalTok{(score)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{boundary =} \DecValTok{0}\NormalTok{, }\AttributeTok{closed =} \StringTok{"left"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ item, }\AttributeTok{ncol =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"HPT item score distributions"}\NormalTok{, }\AttributeTok{x =} \StringTok{"Score (1{-}4)"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{/home/yetty/Projects/phd-029-hpt-and-extremism/outputs/01_measurement-checks_files/figure-latex/distributions-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Scale/composite distributions}
\NormalTok{long\_scales }\OtherTok{\textless{}{-}}\NormalTok{ hpt\_scores }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(POP\_raw, ROA, CONT, HPT\_CTX6, HPT\_TOT9) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{everything}\NormalTok{(), }\AttributeTok{names\_to =} \StringTok{"scale"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"score"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(long\_scales, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ score)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ scale, }\AttributeTok{scales =} \StringTok{"free"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Subscales and composites"}\NormalTok{, }\AttributeTok{x =} \StringTok{"Mean score"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{/home/yetty/Projects/phd-029-hpt-and-extremism/outputs/01_measurement-checks_files/figure-latex/distributions-2.pdf}

\hypertarget{step-6-class-level-iccs-multilevel-warranted}{%
\section{Step 6 --- Class-level ICCs (multilevel
warranted?)}\label{step-6-class-level-iccs-multilevel-warranted}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Build the DV frame from analysis\_df (items) and compute subscales/composites here}
\NormalTok{icc\_data }\OtherTok{\textless{}{-}}\NormalTok{ analysis\_df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{POP\_raw =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{select}\NormalTok{(., }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"POP"}\NormalTok{)),  }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{ROA     =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{select}\NormalTok{(., }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"ROA"}\NormalTok{)),  }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{CONT    =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{select}\NormalTok{(., }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"CONT"}\NormalTok{)), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{POP\_rev  =} \DecValTok{5} \SpecialCharTok{{-}}\NormalTok{ POP\_raw,}
    \AttributeTok{HPT\_CTX6 =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(POP\_rev, CONT), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{HPT\_TOT9 =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(POP\_rev, CONT, ROA), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(school\_id, class\_label, class\_id, POP\_raw, ROA, CONT, HPT\_CTX6, HPT\_TOT9)}

\NormalTok{mk\_icc\_3 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(dv)\{}
\NormalTok{  f }\OtherTok{\textless{}{-}} \FunctionTok{reformulate}\NormalTok{(}\StringTok{"1 + (1|school\_id) + (1|school\_id:class\_label)"}\NormalTok{, }\AttributeTok{response =}\NormalTok{ dv)}
\NormalTok{  fit }\OtherTok{\textless{}{-}} \FunctionTok{lmer}\NormalTok{(f, }\AttributeTok{data =}\NormalTok{ icc\_data, }\AttributeTok{REML =} \ConstantTok{TRUE}\NormalTok{)}

\NormalTok{  vc }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{VarCorr}\NormalTok{(fit))}
\NormalTok{  v\_school }\OtherTok{\textless{}{-}}\NormalTok{ vc}\SpecialCharTok{$}\NormalTok{vcov[vc}\SpecialCharTok{$}\NormalTok{grp }\SpecialCharTok{==} \StringTok{"school\_id"}\NormalTok{];             v\_school }\OtherTok{\textless{}{-}} \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(v\_school)) v\_school[}\DecValTok{1}\NormalTok{] }\ControlFlowTok{else} \DecValTok{0}
\NormalTok{  v\_classW }\OtherTok{\textless{}{-}}\NormalTok{ vc}\SpecialCharTok{$}\NormalTok{vcov[vc}\SpecialCharTok{$}\NormalTok{grp }\SpecialCharTok{==} \StringTok{"school\_id:class\_label"}\NormalTok{]; v\_classW }\OtherTok{\textless{}{-}} \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(v\_classW)) v\_classW[}\DecValTok{1}\NormalTok{] }\ControlFlowTok{else} \DecValTok{0}
\NormalTok{  v\_resid  }\OtherTok{\textless{}{-}}\NormalTok{ vc}\SpecialCharTok{$}\NormalTok{vcov[vc}\SpecialCharTok{$}\NormalTok{grp }\SpecialCharTok{==} \StringTok{"Residual"}\NormalTok{][}\DecValTok{1}\NormalTok{]}
\NormalTok{  v\_tot    }\OtherTok{\textless{}{-}}\NormalTok{ v\_school }\SpecialCharTok{+}\NormalTok{ v\_classW }\SpecialCharTok{+}\NormalTok{ v\_resid}

  \FunctionTok{tibble}\NormalTok{(}
    \AttributeTok{DV =}\NormalTok{ dv,}
    \AttributeTok{ICC\_school =}\NormalTok{ v\_school }\SpecialCharTok{/}\NormalTok{ v\_tot,}
    \AttributeTok{ICC\_class\_within\_school =}\NormalTok{ v\_classW }\SpecialCharTok{/}\NormalTok{ v\_tot,}
    \AttributeTok{ICC\_total\_cluster =}\NormalTok{ (v\_school }\SpecialCharTok{+}\NormalTok{ v\_classW) }\SpecialCharTok{/}\NormalTok{ v\_tot,}
    \AttributeTok{singular =} \FunctionTok{isSingular}\NormalTok{(fit)}
\NormalTok{  )}
\NormalTok{\}}

\NormalTok{icc\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ purrr}\SpecialCharTok{::}\FunctionTok{map\_dfr}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"HPT\_CTX6"}\NormalTok{,}\StringTok{"HPT\_TOT9"}\NormalTok{,}\StringTok{"POP\_raw"}\NormalTok{,}\StringTok{"ROA"}\NormalTok{,}\StringTok{"CONT"}\NormalTok{), mk\_icc\_3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## boundary (singular) fit: see help('isSingular')
## boundary (singular) fit: see help('isSingular')
## boundary (singular) fit: see help('isSingular')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print\_tbl}\NormalTok{(icc\_tbl, }\AttributeTok{digits =} \DecValTok{3}\NormalTok{, }\AttributeTok{caption =} \StringTok{"ICCs: school and class{-}within{-}school (HPT composites and subscales)."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[t]{lrrrl}
\caption{\label{tab:icc}ICCs: school and class-within-school (HPT composites and subscales).}\\
\toprule
DV & ICC\_school & ICC\_class\_within\_school & ICC\_total\_cluster & singular\\
\midrule
HPT\_CTX6 & 0.050 & 0.000 & 0.050 & TRUE\\
HPT\_TOT9 & 0.081 & 0.000 & 0.081 & TRUE\\
POP\_raw & 0.036 & 0.000 & 0.036 & TRUE\\
ROA & 0.037 & 0.003 & 0.040 & FALSE\\
CONT & 0.040 & 0.012 & 0.053 & FALSE\\
\bottomrule
\end{longtable}

\hypertarget{step-7-knowledge-mini-test-kn1kn6}{%
\section{Step 7 --- Knowledge mini-test
(KN1--KN6)}\label{step-7-knowledge-mini-test-kn1kn6}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{kn\_cols }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"KN"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{)}
\NormalTok{has\_kn  }\OtherTok{\textless{}{-}} \FunctionTok{all}\NormalTok{(kn\_cols }\SpecialCharTok{\%in\%} \FunctionTok{names}\NormalTok{(dat))}

\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\NormalTok{has\_kn) \{}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{**Knowledge section skipped:** KN1–KN6 not found in data.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  kn\_items }\OtherTok{\textless{}{-}}\NormalTok{ dat[keep, kn\_cols]  }\CommentTok{\# align to analysis\_df rows via \textquotesingle{}keep\textquotesingle{}}
  \CommentTok{\# Basic sanity: coerce to numeric 0/1}
\NormalTok{  kn\_items }\OtherTok{\textless{}{-}}\NormalTok{ kn\_items }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{everything}\NormalTok{(), }\SpecialCharTok{\textasciitilde{}} \FunctionTok{as.numeric}\NormalTok{(.)))}

  \CommentTok{\# Total score, difficulty (p), discrimination (point{-}biserial)}
\NormalTok{  kn\_total }\OtherTok{\textless{}{-}} \FunctionTok{rowSums}\NormalTok{(kn\_items, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}

\NormalTok{  item\_stats }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
    \AttributeTok{item =}\NormalTok{ kn\_cols,}
    \AttributeTok{difficulty\_p =} \FunctionTok{sapply}\NormalTok{(kn\_items, }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{mean}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)),}
    \AttributeTok{discr\_pb =} \FunctionTok{sapply}\NormalTok{(kn\_items, }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{cor}\NormalTok{(x, kn\_total }\SpecialCharTok{{-}}\NormalTok{ x, }\AttributeTok{use =} \StringTok{"pairwise.complete.obs"}\NormalTok{))}
\NormalTok{  )}

  \CommentTok{\# KR{-}20 (alpha on dichotomous items)}
\NormalTok{  kn\_alpha }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(kn\_items)}

  \FunctionTok{print\_tbl}\NormalTok{(item\_stats, }\AttributeTok{digits =} \DecValTok{3}\NormalTok{, }\AttributeTok{caption =} \StringTok{"KN items: difficulty (p) and point{-}biserial discrimination."}\NormalTok{)}

  \FunctionTok{print\_tbl}\NormalTok{(}\FunctionTok{tibble}\NormalTok{(}
    \AttributeTok{k\_items =} \FunctionTok{ncol}\NormalTok{(kn\_items),}
    \AttributeTok{total\_mean =} \FunctionTok{mean}\NormalTok{(kn\_total, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{total\_sd   =} \FunctionTok{sd}\NormalTok{(kn\_total, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{alpha\_KR20 =} \FunctionTok{unname}\NormalTok{(kn\_alpha}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha)}
\NormalTok{  ), }\AttributeTok{digits =} \DecValTok{3}\NormalTok{, }\AttributeTok{caption =} \StringTok{"KN total: summary and KR{-}20 (alpha for dichotomous items)."}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[t]{rrrr}
\caption{\label{tab:kn-items}KN total: summary and KR-20 (alpha for dichotomous items).}\\
\toprule
k\_items & total\_mean & total\_sd & alpha\_KR20\\
\midrule
6 & 3.131 & 1.656 & 0.567\\
\bottomrule
\end{longtable}

\hypertarget{step-8-ideology-batteries-fr-lf-mini-ksa-3-and-social-desirability-sdr-5}{%
\section{Step 8 --- Ideology batteries (FR-LF mini, KSA-3) and Social
Desirability
(SDR-5)}\label{step-8-ideology-batteries-fr-lf-mini-ksa-3-and-social-desirability-sdr-5}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Helper: reliability table for Likert batteries (polychoric + omega total)}
\NormalTok{alpha\_poly\_likert }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  pc }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{polychoric}\NormalTok{(x)}\SpecialCharTok{$}\NormalTok{rho}
\NormalTok{  psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(pc, }\AttributeTok{n.obs =} \FunctionTok{nrow}\NormalTok{(x))}
\NormalTok{\}}
\NormalTok{omega\_total\_poly\_likert }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  pc }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{polychoric}\NormalTok{(x)}\SpecialCharTok{$}\NormalTok{rho}
  \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{all}\NormalTok{(}\FunctionTok{eigen}\NormalTok{(pc, }\AttributeTok{symmetric =} \ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{$}\NormalTok{values }\SpecialCharTok{\textgreater{}} \FloatTok{1e{-}6}\NormalTok{)) pc }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{cor.smooth}\NormalTok{(pc)}
  \FunctionTok{suppressWarnings}\NormalTok{(psych}\SpecialCharTok{::}\FunctionTok{omega}\NormalTok{(pc, }\AttributeTok{n.obs =} \FunctionTok{nrow}\NormalTok{(x), }\AttributeTok{nfactors =} \DecValTok{1}\NormalTok{, }\AttributeTok{plot =} \ConstantTok{FALSE}\NormalTok{)}\SpecialCharTok{$}\NormalTok{omega.tot)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{fr-lf-mini-rd1rd3-ns1ns3}{%
\subsection{FR-LF mini (RD1--RD3,
NS1--NS3)}\label{fr-lf-mini-rd1rd3-ns1ns3}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fr\_cols }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"RD"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{), }\FunctionTok{paste0}\NormalTok{(}\StringTok{"NS"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{))}
\NormalTok{has\_fr  }\OtherTok{\textless{}{-}} \FunctionTok{all}\NormalTok{(fr\_cols }\SpecialCharTok{\%in\%} \FunctionTok{names}\NormalTok{(dat))}

\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\NormalTok{has\_fr) \{}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{**FR{-}LF mini section skipped:** RD1–3 and/or NS1–3 not found.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  fr\_df }\OtherTok{\textless{}{-}}\NormalTok{ dat[keep, fr\_cols] }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{as\_tibble}\NormalTok{()}
\NormalTok{  RD }\OtherTok{\textless{}{-}}\NormalTok{ fr\_df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"RD"}\NormalTok{))}
\NormalTok{  NS }\OtherTok{\textless{}{-}}\NormalTok{ fr\_df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"NS"}\NormalTok{))}

\NormalTok{  fr\_rel }\OtherTok{\textless{}{-}} \FunctionTok{bind\_rows}\NormalTok{(}
\NormalTok{    \{}
\NormalTok{      a }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(RD); ap }\OtherTok{\textless{}{-}} \FunctionTok{alpha\_poly\_likert}\NormalTok{(RD); wt }\OtherTok{\textless{}{-}} \FunctionTok{omega\_total\_poly\_likert}\NormalTok{(RD)}
      \FunctionTok{tibble}\NormalTok{(}\AttributeTok{scale =} \StringTok{"FR{-}LF: RD"}\NormalTok{, }\AttributeTok{k\_items =} \FunctionTok{ncol}\NormalTok{(RD),}
             \AttributeTok{alpha\_raw =}\NormalTok{ a}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{alpha\_poly =}\NormalTok{ ap}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{omega\_total =}\NormalTok{ wt)}
\NormalTok{    \},}
\NormalTok{    \{}
\NormalTok{      a }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(NS); ap }\OtherTok{\textless{}{-}} \FunctionTok{alpha\_poly\_likert}\NormalTok{(NS); wt }\OtherTok{\textless{}{-}} \FunctionTok{omega\_total\_poly\_likert}\NormalTok{(NS)}
      \FunctionTok{tibble}\NormalTok{(}\AttributeTok{scale =} \StringTok{"FR{-}LF: NS"}\NormalTok{, }\AttributeTok{k\_items =} \FunctionTok{ncol}\NormalTok{(NS),}
             \AttributeTok{alpha\_raw =}\NormalTok{ a}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{alpha\_poly =}\NormalTok{ ap}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{omega\_total =}\NormalTok{ wt)}
\NormalTok{    \},}
\NormalTok{    \{}
\NormalTok{      a }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(fr\_df); ap }\OtherTok{\textless{}{-}} \FunctionTok{alpha\_poly\_likert}\NormalTok{(fr\_df); wt }\OtherTok{\textless{}{-}} \FunctionTok{omega\_total\_poly\_likert}\NormalTok{(fr\_df)}
      \FunctionTok{tibble}\NormalTok{(}\AttributeTok{scale =} \StringTok{"FR{-}LF: total (RD+NS)"}\NormalTok{, }\AttributeTok{k\_items =} \FunctionTok{ncol}\NormalTok{(fr\_df),}
             \AttributeTok{alpha\_raw =}\NormalTok{ a}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{alpha\_poly =}\NormalTok{ ap}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{omega\_total =}\NormalTok{ wt)}
\NormalTok{    \}}
\NormalTok{  )}

  \FunctionTok{print\_tbl}\NormalTok{(fr\_rel, }\AttributeTok{digits =} \DecValTok{3}\NormalTok{, }\AttributeTok{caption =} \StringTok{"FR{-}LF mini reliability (alpha, polychoric alpha, omega total)."}\NormalTok{)}

  \CommentTok{\# Optional CFA: 2 correlated factors (RD, NS), ordered WLSMV}
\NormalTok{  fr\_model }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}}
\StringTok{  RD =\textasciitilde{} RD1 + RD2 + RD3}
\StringTok{  NS =\textasciitilde{} NS1 + NS2 + NS3}
\StringTok{  RD \textasciitilde{}\textasciitilde{} NS}
\StringTok{  \textquotesingle{}}
\NormalTok{  fr\_fit }\OtherTok{\textless{}{-}} \FunctionTok{try}\NormalTok{(lavaan}\SpecialCharTok{::}\FunctionTok{cfa}\NormalTok{(fr\_model, }\AttributeTok{data =}\NormalTok{ fr\_df, }\AttributeTok{ordered =} \FunctionTok{colnames}\NormalTok{(fr\_df), }\AttributeTok{estimator =} \StringTok{"WLSMV"}\NormalTok{), }\AttributeTok{silent =} \ConstantTok{TRUE}\NormalTok{)}
  \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{inherits}\NormalTok{(fr\_fit, }\StringTok{"try{-}error"}\NormalTok{)) \{}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{fitMeasures}\NormalTok{(fr\_fit, }\FunctionTok{c}\NormalTok{(}\StringTok{"cfi"}\NormalTok{,}\StringTok{"tli"}\NormalTok{,}\StringTok{"rmsea"}\NormalTok{,}\StringTok{"srmr"}\NormalTok{)))}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{FR{-}LF CFA skipped (model failed to converge).}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Omega_h for 1 factor is not meaningful, just omega_t
## Omega_h for 1 factor is not meaningful, just omega_t
## Omega_h for 1 factor is not meaningful, just omega_t
\end{verbatim}

\begin{verbatim}
##   cfi   tli rmsea  srmr 
## 0.984 0.970 0.063 0.054
\end{verbatim}

\hypertarget{ksa-3-a1a3-u1u3-k1k3}{%
\subsection{KSA-3 (A1--A3, U1--U3, K1--K3)}\label{ksa-3-a1a3-u1u3-k1k3}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ksa\_cols }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"A"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{), }\FunctionTok{paste0}\NormalTok{(}\StringTok{"U"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{), }\FunctionTok{paste0}\NormalTok{(}\StringTok{"K"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{))}
\NormalTok{has\_ksa  }\OtherTok{\textless{}{-}} \FunctionTok{all}\NormalTok{(ksa\_cols }\SpecialCharTok{\%in\%} \FunctionTok{names}\NormalTok{(dat))}

\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\NormalTok{has\_ksa) \{}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{**KSA{-}3 section skipped:** A1–A3, U1–U3, and/or K1–K3 not found.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  ksa\_df }\OtherTok{\textless{}{-}}\NormalTok{ dat[keep, ksa\_cols] }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{as\_tibble}\NormalTok{()}
\NormalTok{  A }\OtherTok{\textless{}{-}}\NormalTok{ ksa\_df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"A"}\NormalTok{))}
\NormalTok{  U }\OtherTok{\textless{}{-}}\NormalTok{ ksa\_df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"U"}\NormalTok{))}
\NormalTok{  K }\OtherTok{\textless{}{-}}\NormalTok{ ksa\_df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"K"}\NormalTok{))}

\NormalTok{  ksa\_rel }\OtherTok{\textless{}{-}} \FunctionTok{bind\_rows}\NormalTok{(}
\NormalTok{    \{}
\NormalTok{      a }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(A); ap }\OtherTok{\textless{}{-}} \FunctionTok{alpha\_poly\_likert}\NormalTok{(A); wt }\OtherTok{\textless{}{-}} \FunctionTok{omega\_total\_poly\_likert}\NormalTok{(A)}
      \FunctionTok{tibble}\NormalTok{(}\AttributeTok{scale =} \StringTok{"KSA{-}3: Aggression (A)"}\NormalTok{, }\AttributeTok{k\_items =} \DecValTok{3}\NormalTok{,}
             \AttributeTok{alpha\_raw =}\NormalTok{ a}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{alpha\_poly =}\NormalTok{ ap}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{omega\_total =}\NormalTok{ wt)}
\NormalTok{    \},}
\NormalTok{    \{}
\NormalTok{      a }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(U); ap }\OtherTok{\textless{}{-}} \FunctionTok{alpha\_poly\_likert}\NormalTok{(U); wt }\OtherTok{\textless{}{-}} \FunctionTok{omega\_total\_poly\_likert}\NormalTok{(U)}
      \FunctionTok{tibble}\NormalTok{(}\AttributeTok{scale =} \StringTok{"KSA{-}3: Submission (U)"}\NormalTok{, }\AttributeTok{k\_items =} \DecValTok{3}\NormalTok{,}
             \AttributeTok{alpha\_raw =}\NormalTok{ a}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{alpha\_poly =}\NormalTok{ ap}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{omega\_total =}\NormalTok{ wt)}
\NormalTok{    \},}
\NormalTok{    \{}
\NormalTok{      a }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(K); ap }\OtherTok{\textless{}{-}} \FunctionTok{alpha\_poly\_likert}\NormalTok{(K); wt }\OtherTok{\textless{}{-}} \FunctionTok{omega\_total\_poly\_likert}\NormalTok{(K)}
      \FunctionTok{tibble}\NormalTok{(}\AttributeTok{scale =} \StringTok{"KSA{-}3: Conventionalism (K)"}\NormalTok{, }\AttributeTok{k\_items =} \DecValTok{3}\NormalTok{,}
             \AttributeTok{alpha\_raw =}\NormalTok{ a}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{alpha\_poly =}\NormalTok{ ap}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{omega\_total =}\NormalTok{ wt)}
\NormalTok{    \},}
\NormalTok{    \{}
\NormalTok{      a }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(ksa\_df); ap }\OtherTok{\textless{}{-}} \FunctionTok{alpha\_poly\_likert}\NormalTok{(ksa\_df); wt }\OtherTok{\textless{}{-}} \FunctionTok{omega\_total\_poly\_likert}\NormalTok{(ksa\_df)}
      \FunctionTok{tibble}\NormalTok{(}\AttributeTok{scale =} \StringTok{"KSA{-}3: total"}\NormalTok{, }\AttributeTok{k\_items =} \DecValTok{9}\NormalTok{,}
             \AttributeTok{alpha\_raw =}\NormalTok{ a}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{alpha\_poly =}\NormalTok{ ap}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha, }\AttributeTok{omega\_total =}\NormalTok{ wt)}
\NormalTok{    \}}
\NormalTok{  )}

  \FunctionTok{print\_tbl}\NormalTok{(ksa\_rel, }\AttributeTok{digits =} \DecValTok{3}\NormalTok{, }\AttributeTok{caption =} \StringTok{"KSA{-}3 reliability (alpha, polychoric alpha, omega total)."}\NormalTok{)}

  \CommentTok{\# Optional CFA: 3 correlated factors (A, U, K)}
\NormalTok{  ksa\_model }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}}
\StringTok{  A =\textasciitilde{} A1 + A2 + A3}
\StringTok{  U =\textasciitilde{} U1 + U2 + U3}
\StringTok{  K =\textasciitilde{} K1 + K2 + K3}
\StringTok{  A \textasciitilde{}\textasciitilde{} U + K}
\StringTok{  U \textasciitilde{}\textasciitilde{} K}
\StringTok{  \textquotesingle{}}
\NormalTok{  ksa\_fit }\OtherTok{\textless{}{-}} \FunctionTok{try}\NormalTok{(lavaan}\SpecialCharTok{::}\FunctionTok{cfa}\NormalTok{(ksa\_model, }\AttributeTok{data =}\NormalTok{ ksa\_df, }\AttributeTok{ordered =} \FunctionTok{colnames}\NormalTok{(ksa\_df), }\AttributeTok{estimator =} \StringTok{"WLSMV"}\NormalTok{), }\AttributeTok{silent =} \ConstantTok{TRUE}\NormalTok{)}
  \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{inherits}\NormalTok{(ksa\_fit, }\StringTok{"try{-}error"}\NormalTok{)) \{}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{fitMeasures}\NormalTok{(ksa\_fit, }\FunctionTok{c}\NormalTok{(}\StringTok{"cfi"}\NormalTok{,}\StringTok{"tli"}\NormalTok{,}\StringTok{"rmsea"}\NormalTok{,}\StringTok{"srmr"}\NormalTok{)))}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{KSA{-}3 CFA skipped (model failed to converge).}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Omega_h for 1 factor is not meaningful, just omega_t
## Omega_h for 1 factor is not meaningful, just omega_t
## Omega_h for 1 factor is not meaningful, just omega_t
## Omega_h for 1 factor is not meaningful, just omega_t
\end{verbatim}

\begin{verbatim}
##   cfi   tli rmsea  srmr 
## 0.971 0.957 0.065 0.065
\end{verbatim}

\hypertarget{sdr-5-sdr1sdr5}{%
\subsection{SDR-5 (SDR1--SDR5)}\label{sdr-5-sdr1sdr5}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sdr\_cols }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"SDR"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)}
\NormalTok{has\_sdr  }\OtherTok{\textless{}{-}} \FunctionTok{all}\NormalTok{(sdr\_cols }\SpecialCharTok{\%in\%} \FunctionTok{names}\NormalTok{(dat))}

\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\NormalTok{has\_sdr) \{}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{**SDR{-}5 section skipped:** SDR1–SDR5 not found.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  sdr\_df }\OtherTok{\textless{}{-}}\NormalTok{ dat[keep, sdr\_cols] }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{as\_tibble}\NormalTok{()}
\NormalTok{  a\_sdr  }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(sdr\_df)}
\NormalTok{  ap\_sdr }\OtherTok{\textless{}{-}} \FunctionTok{alpha\_poly\_likert}\NormalTok{(sdr\_df)}
\NormalTok{  wt\_sdr }\OtherTok{\textless{}{-}} \FunctionTok{omega\_total\_poly\_likert}\NormalTok{(sdr\_df)}

  \FunctionTok{print\_tbl}\NormalTok{(}\FunctionTok{tibble}\NormalTok{(}
    \AttributeTok{scale =} \StringTok{"SDR{-}5"}\NormalTok{,}
    \AttributeTok{k\_items =} \DecValTok{5}\NormalTok{,}
    \AttributeTok{alpha\_raw =}\NormalTok{ a\_sdr}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha,}
    \AttributeTok{alpha\_poly =}\NormalTok{ ap\_sdr}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{raw\_alpha,}
    \AttributeTok{omega\_total =}\NormalTok{ wt\_sdr}
\NormalTok{  ), }\AttributeTok{digits =} \DecValTok{3}\NormalTok{, }\AttributeTok{caption =} \StringTok{"SDR{-}5 reliability (alpha, polychoric alpha, omega total)."}\NormalTok{) }

  \CommentTok{\# Optional CFA: 1 factor}
\NormalTok{  sdr\_model }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}SDR =\textasciitilde{} SDR1 + SDR2 + SDR3 + SDR4 + SDR5\textquotesingle{}}
\NormalTok{  sdr\_fit }\OtherTok{\textless{}{-}} \FunctionTok{try}\NormalTok{(lavaan}\SpecialCharTok{::}\FunctionTok{cfa}\NormalTok{(sdr\_model, }\AttributeTok{data =}\NormalTok{ sdr\_df, }\AttributeTok{ordered =} \FunctionTok{colnames}\NormalTok{(sdr\_df), }\AttributeTok{estimator =} \StringTok{"WLSMV"}\NormalTok{), }\AttributeTok{silent =} \ConstantTok{TRUE}\NormalTok{)}
  \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{inherits}\NormalTok{(sdr\_fit, }\StringTok{"try{-}error"}\NormalTok{)) \{}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{fitMeasures}\NormalTok{(sdr\_fit, }\FunctionTok{c}\NormalTok{(}\StringTok{"cfi"}\NormalTok{,}\StringTok{"tli"}\NormalTok{,}\StringTok{"rmsea"}\NormalTok{,}\StringTok{"srmr"}\NormalTok{)))}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{SDR{-}5 CFA skipped (model failed to converge).}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Some items ( SDR1 SDR5 ) were negatively correlated with the first principal component and 
## probably should be reversed.  
## To do this, run the function again with the 'check.keys=TRUE' option
\end{verbatim}

\begin{verbatim}
## Some items ( SDR1 SDR5 ) were negatively correlated with the first principal component and 
## probably should be reversed.  
## To do this, run the function again with the 'check.keys=TRUE' option
\end{verbatim}

\begin{verbatim}
## Omega_h for 1 factor is not meaningful, just omega_t
\end{verbatim}

\begin{verbatim}
##   cfi   tli rmsea  srmr 
## 0.776 0.552 0.187 0.105
\end{verbatim}

\hypertarget{step-9-cross-construct-correlations-hpt-kn-fr-lf-ksa-3-sdr-5}{%
\section{Step 9 --- Cross-construct correlations (HPT, KN, FR-LF, KSA-3,
SDR-5)}\label{step-9-cross-construct-correlations-hpt-kn-fr-lf-ksa-3-sdr-5}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Build scale scores that exist in your data (gracefully skipping any missing block)}
\NormalTok{scales\_list }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{HPT\_CTX6  =}\NormalTok{ hpt\_scores}\SpecialCharTok{$}\NormalTok{HPT\_CTX6,}
  \AttributeTok{HPT\_TOT9  =}\NormalTok{ hpt\_scores}\SpecialCharTok{$}\NormalTok{HPT\_TOT9,}
  \AttributeTok{HPT\_POP   =}\NormalTok{ hpt\_scores}\SpecialCharTok{$}\NormalTok{POP\_raw,  }\CommentTok{\# presentism foil (higher = worse)}
  \AttributeTok{HPT\_ROA   =}\NormalTok{ hpt\_scores}\SpecialCharTok{$}\NormalTok{ROA,}
  \AttributeTok{HPT\_CONT  =}\NormalTok{ hpt\_scores}\SpecialCharTok{$}\NormalTok{CONT}
\NormalTok{)}

\CommentTok{\# optional blocks}
\NormalTok{kn\_cols }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"KN"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{); has\_kn }\OtherTok{\textless{}{-}} \FunctionTok{all}\NormalTok{(kn\_cols }\SpecialCharTok{\%in\%} \FunctionTok{names}\NormalTok{(dat))}
\NormalTok{fr\_cols }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"RD"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{), }\FunctionTok{paste0}\NormalTok{(}\StringTok{"NS"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)); has\_fr }\OtherTok{\textless{}{-}} \FunctionTok{all}\NormalTok{(fr\_cols }\SpecialCharTok{\%in\%} \FunctionTok{names}\NormalTok{(dat))}
\NormalTok{ksa\_cols }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"A"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{), }\FunctionTok{paste0}\NormalTok{(}\StringTok{"U"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{), }\FunctionTok{paste0}\NormalTok{(}\StringTok{"K"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)); has\_ksa }\OtherTok{\textless{}{-}} \FunctionTok{all}\NormalTok{(ksa\_cols }\SpecialCharTok{\%in\%} \FunctionTok{names}\NormalTok{(dat))}
\NormalTok{sdr\_cols }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"SDR"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{); has\_sdr }\OtherTok{\textless{}{-}} \FunctionTok{all}\NormalTok{(sdr\_cols }\SpecialCharTok{\%in\%} \FunctionTok{names}\NormalTok{(dat))}

\ControlFlowTok{if}\NormalTok{ (has\_kn) \{}
\NormalTok{  scales\_list}\SpecialCharTok{$}\NormalTok{KN\_total }\OtherTok{\textless{}{-}} \FunctionTok{rowSums}\NormalTok{(dat[keep, kn\_cols], }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}

\ControlFlowTok{if}\NormalTok{ (has\_fr) \{}
\NormalTok{  fr\_df }\OtherTok{\textless{}{-}}\NormalTok{ dat[keep, fr\_cols]}
\NormalTok{  scales\_list}\SpecialCharTok{$}\NormalTok{FR\_RD     }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(fr\_df[, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"RD"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)], }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  scales\_list}\SpecialCharTok{$}\NormalTok{FR\_NS     }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(fr\_df[, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"NS"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)], }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  scales\_list}\SpecialCharTok{$}\NormalTok{FR\_total  }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(fr\_df, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}

\ControlFlowTok{if}\NormalTok{ (has\_ksa) \{}
\NormalTok{  ksa\_df }\OtherTok{\textless{}{-}}\NormalTok{ dat[keep, ksa\_cols]}
\NormalTok{  scales\_list}\SpecialCharTok{$}\NormalTok{KSA\_A     }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(ksa\_df[, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"A"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)], }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  scales\_list}\SpecialCharTok{$}\NormalTok{KSA\_U     }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(ksa\_df[, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"U"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)], }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  scales\_list}\SpecialCharTok{$}\NormalTok{KSA\_K     }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(ksa\_df[, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"K"}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)], }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  scales\_list}\SpecialCharTok{$}\NormalTok{KSA\_total }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(ksa\_df, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}

\ControlFlowTok{if}\NormalTok{ (has\_sdr) \{}
\NormalTok{  sdr\_df }\OtherTok{\textless{}{-}}\NormalTok{ dat[keep, sdr\_cols]}
\NormalTok{  scales\_list}\SpecialCharTok{$}\NormalTok{SDR\_total }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(sdr\_df, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}

\NormalTok{scales\_df }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble}\NormalTok{(scales\_list)}

\CommentTok{\# Pairwise complete correlations}
\NormalTok{cors }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(scales\_df, }\AttributeTok{use =} \StringTok{"pairwise.complete.obs"}\NormalTok{)}

\FunctionTok{print\_tbl}\NormalTok{(}\FunctionTok{round}\NormalTok{(cors, }\DecValTok{3}\NormalTok{), }\AttributeTok{caption =} \StringTok{"Cross{-}construct correlations (pairwise complete)."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[t]{lrrrrrrrrrrrrrr}
\caption{\label{tab:cross-construct-correlations}Cross-construct correlations (pairwise complete).}\\
\toprule
  & HPT\_CTX6 & HPT\_TOT9 & HPT\_POP & HPT\_ROA & HPT\_CONT & KN\_total & FR\_RD & FR\_NS & FR\_total & KSA\_A & KSA\_U & KSA\_K & KSA\_total & SDR\_total\\
\midrule
HPT\_CTX6 & 1.000 & 0.912 & -0.802 & 0.322 & 0.844 & 0.321 & -0.049 & -0.006 & -0.032 & -0.016 & -0.077 & -0.029 & -0.051 & -0.046\\
HPT\_TOT9 & 0.912 & 1.000 & -0.685 & 0.683 & 0.811 & 0.370 & -0.059 & -0.021 & -0.045 & -0.005 & -0.075 & 0.002 & -0.032 & -0.022\\
HPT\_POP & -0.802 & -0.685 & 1.000 & -0.152 & -0.357 & -0.320 & 0.099 & 0.091 & 0.109 & 0.084 & 0.153 & 0.131 & 0.158 & 0.048\\
HPT\_ROA & 0.322 & 0.683 & -0.152 & 1.000 & 0.368 & 0.282 & -0.048 & -0.037 & -0.047 & 0.017 & -0.035 & 0.056 & 0.017 & 0.032\\
HPT\_CONT & 0.844 & 0.811 & -0.357 & 0.368 & 1.000 & 0.215 & 0.012 & 0.072 & 0.048 & 0.050 & 0.017 & 0.073 & 0.062 & -0.029\\
\addlinespace
KN\_total & 0.321 & 0.370 & -0.320 & 0.282 & 0.215 & 1.000 & -0.062 & -0.150 & -0.129 & 0.014 & 0.023 & 0.087 & 0.059 & 0.001\\
FR\_RD & -0.049 & -0.059 & 0.099 & -0.048 & 0.012 & -0.062 & 1.000 & 0.438 & 0.841 & 0.395 & 0.411 & 0.358 & 0.503 & -0.060\\
FR\_NS & -0.006 & -0.021 & 0.091 & -0.037 & 0.072 & -0.150 & 0.438 & 1.000 & 0.855 & 0.350 & 0.322 & 0.207 & 0.380 & -0.268\\
FR\_total & -0.032 & -0.045 & 0.109 & -0.047 & 0.048 & -0.129 & 0.841 & 0.855 & 1.000 & 0.437 & 0.416 & 0.332 & 0.510 & -0.193\\
KSA\_A & -0.016 & -0.005 & 0.084 & 0.017 & 0.050 & 0.014 & 0.395 & 0.350 & 0.437 & 1.000 & 0.334 & 0.429 & 0.794 & -0.182\\
\addlinespace
KSA\_U & -0.077 & -0.075 & 0.153 & -0.035 & 0.017 & 0.023 & 0.411 & 0.322 & 0.416 & 0.334 & 1.000 & 0.365 & 0.719 & -0.199\\
KSA\_K & -0.029 & 0.002 & 0.131 & 0.056 & 0.073 & 0.087 & 0.358 & 0.207 & 0.332 & 0.429 & 0.365 & 1.000 & 0.778 & -0.032\\
KSA\_total & -0.051 & -0.032 & 0.158 & 0.017 & 0.062 & 0.059 & 0.503 & 0.380 & 0.510 & 0.794 & 0.719 & 0.778 & 1.000 & -0.180\\
SDR\_total & -0.046 & -0.022 & 0.048 & 0.032 & -0.029 & 0.001 & -0.060 & -0.268 & -0.193 & -0.182 & -0.199 & -0.032 & -0.180 & 1.000\\
\bottomrule
\end{longtable}

\hypertarget{reproducibility-appendix}{%
\section{Reproducibility appendix}\label{reproducibility-appendix}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sessionInfo}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## R version 4.4.2 (2024-10-31)
## Platform: x86_64-pc-linux-gnu
## Running under: Ubuntu 24.04.3 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0 
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=cs_CZ.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=cs_CZ.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=cs_CZ.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=cs_CZ.UTF-8 LC_IDENTIFICATION=C       
## 
## time zone: Europe/Prague
## tzcode source: system (glibc)
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] kableExtra_1.4.0   knitr_1.50         performance_0.15.1 lme4_1.1-38        Matrix_1.7-1       semTools_0.5-7    
##  [7] lavaan_0.6-20      psych_2.4.12       lubridate_1.9.4    forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4       
## [13] purrr_1.1.0        readr_2.1.5        tidyr_1.3.1        tibble_3.2.1       ggplot2_4.0.1      tidyverse_2.0.0   
## 
## loaded via a namespace (and not attached):
##  [1] gtable_0.3.6         xfun_0.54            insight_1.4.2        lattice_0.22-5       tzdb_0.5.0          
##  [6] quadprog_1.5-8       vctrs_0.6.5          tools_4.4.2          Rdpack_2.6.4         generics_0.1.3      
## [11] stats4_4.4.2         parallel_4.4.2       sandwich_3.1-1       pkgconfig_2.0.3      lavaan.mi_0.1-0     
## [16] RColorBrewer_1.1-3   S7_0.2.1             lifecycle_1.0.4      GPArotation_2024.3-1 compiler_4.4.2      
## [21] farver_2.1.2         textshaping_0.4.1    mnormt_2.1.1         codetools_0.2-20     htmltools_0.5.8.1   
## [26] yaml_2.3.10          pillar_1.10.0        nloptr_2.2.1         MASS_7.3-61          reformulas_0.4.1    
## [31] boot_1.3-31          multcomp_1.4-28      nlme_3.1-166         tidyselect_1.2.1     digest_0.6.37       
## [36] mvtnorm_1.3-2        stringi_1.8.4        labeling_0.4.3       splines_4.4.2        fastmap_1.2.0       
## [41] grid_4.4.2           cli_3.6.5            magrittr_2.0.3       survival_3.7-0       pbivnorm_0.6.0      
## [46] TH.data_1.1-4        withr_3.0.2          scales_1.4.0         estimability_1.5.1   timechange_0.3.0    
## [51] rmarkdown_2.29       emmeans_1.10.6       zoo_1.8-14           hms_1.1.3            coda_0.19-4.1       
## [56] evaluate_1.0.5       rbibutils_2.3        viridisLite_0.4.2    rlang_1.1.6          Rcpp_1.0.13-1       
## [61] xtable_1.8-4         glue_1.8.0           xml2_1.3.6           svglite_2.2.2        rstudioapi_0.17.1   
## [66] minqa_1.2.8          R6_2.6.1             systemfonts_1.3.1
\end{verbatim}

\end{document}
